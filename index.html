<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Database Systems</title>
    <link rel="stylesheet" href="./assets/css/main.css">

    <link
    href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    rel="stylesheet"
    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
    crossorigin="anonymous"/>

    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

   <script>
      function populateTitle() {
         var selMaker = document.getElementById('title');
         // var selProd = document.getElementById('product');
         // selProd.value = "All";

         const API_URL = 'http://127.0.0.1:8092/api/games';
         axios.get(`${API_URL}`)
            .then(response => {
               console.log(response.data.data);
               
               for (x=0; x<response.data.data.length; x++) {
                  console.log(response.data.data[x].maker);

                  option = document.createElement('option');
                  option.value = response.data.data[x].g_title;
                  option.text = response.data.data[x].g_title;
                  selMaker.appendChild(option);
               }
            })
            .catch(error =>
               console.error('populateTitle', error)
            )
      }

      function runQuery() {
         var selMaker = document.getElementById('title').value;
         // var selProd = document.getElementById('product').value;
         //console.log(selMaker);
         //console.log(selProd);

         var result = document.getElementById('result');
         result.innerHTML = "";

         const API_URL = `http://127.0.0.1:8092/api/games`;
         axios.get(`${API_URL}`)
            .then(response => {
               //console.log(response.data.data);

               if (response.data.data.length == 0) {
                  return;
               }

               let thead = result.createTHead();
               let row = thead.insertRow();
               for (key in response.data.data[0]) {
                  //console.log(key);

                  let th = document.createElement("th");
                  let text = document.createTextNode(key);
                  th.appendChild(text);
                  row.appendChild(th);
               }
               
               for (x=0; x<response.data.data.length; x++) {
                  //console.log(response.data.data[x].maker);

                  let row = result.insertRow();
                  for (k in response.data.data[x]) {
                     console.log(k);

                     let cell = row.insertCell();
                     let text = document.createTextNode(response.data.data[x][k]);
                     cell.appendChild(text);
                  }
               }
            })
            .catch(error =>
               console.error('runQuery', error)
            )
      }
   </script>
</head>
    
<body class="homescreen m-0 flex flex-col bg-gray-800 h-screen text-gray-100" onload="populateTitle()">
   <!-- Top Nav Bar with class title and authors. -->
   <nav class="flex justify-between">
      <p class="text-xl py-8 px-8 uppercase md:px-48">
         Database <span class="text-teal-400 font-bold">Systems</span>
      </p>
      <ul class="flex justify-evenly w-full text-xl py-8 px-0 xl:px-48 xl:w-1/2">
         <li>
            Authors: Ediel & Jonathan
         </li>
      </ul>
   </nav>

   <div style="margin: 30px auto;">
      <label>Title:</label>
      <select name="title" id="title">
         <option value=''>------- Select --------</option>
      </select>
   
      <!-- Execute and display the results. -->
      <button name="runQ" onclick="runQuery()">Find</button>
      <br><br><br>
      <table name="result" id="result"></table>
   </div>

  <script src="./assets/js/star.js"></script>

</body>
</html>
